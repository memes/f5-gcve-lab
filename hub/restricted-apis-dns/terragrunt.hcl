dependencies {
  paths = [
    "${get_repo_root()}/foundations/",
  ]
}

dependency "foundations" {
  config_path = "${get_repo_root()}/foundations/"
  mock_outputs = {
    prefix = "mock-prefix"
  }
}

include "root" {
  path   = find_in_parent_folders()
  expose = true
}

include "env" {
  path   = find_in_parent_folders("env.hcl")
  expose = true
}

include "restricted-apis-dns" {
  path = "${get_repo_root()}/_components/restricted-apis-dns.hcl"
}

remote_state = include.root.remote_state

inputs = {
  project_id = try(include.root.inputs.network_project_id, include.root.inputs.project_id)
  name       = format("%s-%s", dependency.foundations.outputs.prefix, include.env.locals.name)
  labels     = try(include.root.inputs.labels, {})
}
