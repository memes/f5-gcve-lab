variable "prefix" {
  type     = string
  nullable = false
  validation {
    condition     = can(regex("^[a-z][a-z0-9-]{0,62}$", var.prefix))
    error_message = "The prefix variable must be RFC1035 compliant and between 1 and 63 characters in length."
  }
  description = <<-EOD
The prefix to use when naming resources managed by this module. Must be RFC1035
compliant and between 1 and 63 characters in length, inclusive.
EOD
}

variable "project_id" {
  type     = string
  nullable = false
  validation {
    condition     = can(regex("^[a-z][a-z0-9-]{4,28}[a-z0-9]$", var.project_id))
    error_message = "The project_id variable must must be 6 to 30 lowercase letters, digits, or hyphens; it must start with a letter and cannot end with a hyphen."
  }
  description = <<-EOD
The GCP project identifier where the resources will be created
EOD
}

variable "regions" {
  type     = list(string)
  nullable = false
  validation {
    condition     = alltrue([for region in var.regions : can(regex("^[a-z]{2,20}-[a-z]{4,20}[0-9]$", region))])
    error_message = "Every region value must be a valid GCE region name."
  }
  description = <<-EOD
The compute regions where where the resources will be deployed.
EOD
}

variable "gcve_admins" {
  type     = list(string)
  nullable = true
  validation {
    condition     = var.gcve_admins == null ? true : alltrue([for member in var.gcve_admins : can(regex("^(group|serviceAccount|user):[^@]+@[^@]+$", member))])
    error_message = "Each gcve_admins value must be a fully-qualified IAM email address. E.g. serviceAccount:foo@project.iam.gserviceaccount.com."
  }
  default     = null
  description = <<-EOD
  An optional list of accounts that will be assigned the VMware engine admin role. Default is
  an empty list.
  EOD
}

variable "gcve_viewers" {
  type     = list(string)
  nullable = true
  validation {
    condition     = var.gcve_viewers == null ? true : alltrue([for member in var.gcve_viewers : can(regex("^(group|serviceAccount|user):[^@]+@[^@]+$", member))])
    error_message = "Each gcve_viewers value must be a fully-qualified IAM email address. E.g. serviceAccount:foo@project.iam.gserviceaccount.com."
  }
  default     = null
  description = <<-EOD
  An optional list of accounts that will be assigned the VMware engine viewer role. Default is
  an empty list.
  EOD
}
